<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles/covid19_stats_styles.css">
    <title>Statistics for Covid19 India</title>
</head>

<body>
    <header class="page-header">
        <div class="container">
            <nav class="main-menu">
                <a href="#" class="brand-logo">
                    <img src="static/vac.svg" alt="">
                </a>
                <div class="main-menu__drawer">
                    <button class="button main-menu__toggle">Toggle</button>
                    <ul class="main-menu__dropdown">
                        <li>
                            <a href="#" class="main-menu__item">
                                About Us
                            </a>
                        </li>
                        <li>
                            <a href="#" class="main-menu__item">
                                Contact Us
                            </a>
                        </li>
                        <li>
                            <a href="#" class="main-menu__item">
                                Useful links
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>
        </div>
    </header>
    <div class="container grid-container">
        <div class="sidebar__container">
            <aside class="sidebar">
                <div class="dropdown">
                    <button class="button dropdown__button">States</button>
                    <ul class="dropdown__menu" id="states_dropdown">
                    </ul>
                </div>
                <div id="category_dropdown" class="dropdown">
                    <button class="button dropdown__button">Category</button>
                    <ul class="dropdown__menu">
                        <li class="dropdown__item-selected" data-category="confirmed">Confirmed</li>
                        <li data-category="active">Active</li>
                        <li data-category="recovered">Recovered</li>
                        <li data-category="deceased">Deceased</li>
                    </ul>
                </div>
            </aside>
        </div>
        <div class="main__container">
            <main class="main">
                <svg class="map" width="100%" height="100%"></svg>
            </main>
        </div>
        <footer>
            Made with Insomnia at AGARTALA by Gintama Fans!
        </footer>
    </div>
    <script type="module">
        import { STATE_NAMES } from './scripts/constants.js';

        let states_dropdown = document.getElementById("states_dropdown");
        
        Object.entries(STATE_NAMES).forEach(([code, name]) => {
            let listItem = document.createElement("li");
            listItem.setAttribute("data-stcode", code);
            listItem.textContent = name;
            if (code == "TT") listItem.classList.add("dropdown__item-selected");
            states_dropdown.appendChild(listItem);
        });
    </script>
    <script>
        let toggle = document.getElementsByClassName("main-menu__toggle")[0];
        let menu = document.getElementsByClassName("main-menu")[0];
        let menuItems = document.querySelectorAll(".main-menu__dropdown > li");

        toggle.addEventListener("click", function (event) {
            event.preventDefault();
            menu.classList.toggle("is-open");
        });

        for (let item of menuItems) {
            item.addEventListener("click", function(event) {
                event.preventDefault();
                menu.classList.remove("is-open");
            });
        }
    </script>
    <script type="module">
        let dropdowns = document.getElementsByClassName("dropdown");
        let buttons = document.getElementsByClassName("dropdown__button");
        let menus = document.getElementsByClassName("dropdown__menu");

        for (let i=0; i<dropdowns.length; i++) {
            buttons[i].addEventListener("click", function(event) {
                event.preventDefault();
                dropdowns[i].classList.toggle("is-open");
            });

            for (let j=0; j<menus[i].children.length; j++) {
                menus[i].children[j].addEventListener("click", function(event) {
                    event.preventDefault();
                    dropdowns[i].classList.toggle("is-open");
                    menus[i].getElementsByClassName("dropdown__item-selected")[0].classList.toggle("dropdown__item-selected");
                    menus[i].children[j].classList.toggle("dropdown__item-selected");
                    buttons[i].textContent = menus[i].children[j].textContent;
                });

                if (menus[i].children[j].classList.contains("dropdown__item-selected")) {
                    buttons[i].textContent = menus[i].children[j].textContent;
                }
            }
        }
    </script>
    <script src="scripts/d3.v7.min.js"></script>
    <script src="scripts/topojson.js"></script>
    <script type="module" src="scripts/visualize.js"></script>
</body>

</html>